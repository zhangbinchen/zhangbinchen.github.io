<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>文件操作 | ZhangBinchen&#39;s Blog</title>
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url()">
        <div class='av-pic' style="background-image: url(https://avatars3.githubusercontent.com/u/26861951?s=400&amp;u=097c794be5974849f47c6afd8cc1a191ee90eb20&amp;v=4)">
        </div>
    </section>
    <section class='menu'>
        <div>ZhangBinchen&#39;s Blog</div>
        
            <div>E-mail:17794224898@163.com</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>时间轴</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
            
                <a href="https://github.com/zhangbinchen">
                    <img src="/assets/github.svg" />
                </a>
            
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>文件操作</h1>
    </header>

    <section>
      <h3 id="磁盘文件和设备文件"><a href="#磁盘文件和设备文件" class="headerlink" title="磁盘文件和设备文件"></a>磁盘文件和设备文件</h3><ul>
<li>磁盘文件<br>指一组相关数据的有序集合，通常存储在外部介质（如磁盘）上，使用时才调入内存</li>
<li>设备文件<br>在操作系统中把每一个与主机相连的输入、输出设备看作一个文件，把他们的输入输出等同于对磁盘文件的读和写<blockquote>
<p>磁盘文件的分类<br>计算机的存储在物理上是二进制的，所以物理上所有的磁盘文件本质上都是一样的：以字节为单位进行顺序存储</p>
</blockquote>
</li>
<li>从用户或者操作系统的使用角度（逻辑上）把文件分为：</li>
</ul>
<ol>
<li>文本文件：基于字符编码的文件</li>
</ol>
<ul>
<li>基于字符编码，常见编码有ASCII、UNICODE等</li>
<li>一般可以使用文本编辑器直接打开</li>
<li>数5678的以ASCII存储形式（ASCII）为：00110101 00110110 00110111 00111000</li>
</ul>
<ol start="2">
<li>二进制文件：基于值编码的文件</li>
</ol>
<ul>
<li>基于值编码，自己根据具体应用，指定某个值是什么意思</li>
<li>把内存中的数据按其在内存中的存储形式原样输出到磁盘上</li>
<li>数5678的存储形式（二进制码）为：00010110 00101110<a id="more"></a>
<h3 id="文件的打开和关闭"><a href="#文件的打开和关闭" class="headerlink" title="文件的打开和关闭"></a>文件的打开和关闭</h3><h5 id="文件指针"><a href="#文件指针" class="headerlink" title="文件指针"></a>文件指针</h5>在c语言中用一个指针变量指向一个文件，这个指针称为文件指针<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">short</span>         level;  <span class="comment">/*缓冲区满或者空的程度*/</span></span><br><span class="line">    <span class="keyword">unsigned</span>      flags;  <span class="comment">/*文件状态标志*/</span></span><br><span class="line">    <span class="keyword">char</span>          fd;     <span class="comment">/*文件描述符*/</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> hold;   <span class="comment">/*如无缓冲区不读取字符*/</span></span><br><span class="line">    <span class="keyword">short</span>         bsize;  <span class="comment">/*缓冲区的大小*/</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *buffer;<span class="comment">/*数据缓冲区的位置*/</span></span><br><span class="line">    <span class="keyword">unsigned</span>      ar;     <span class="comment">/*指针，当前的指向*/</span></span><br><span class="line">    <span class="keyword">unsigned</span>      istemp; <span class="comment">/*临时文件，指示器*/</span></span><br><span class="line">    <span class="keyword">short</span>         token;  <span class="comment">/*用于有效性的检查*/</span></span><br><span class="line">&#125;FILE;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>【文件指针和普通指针的区别：】</p>
<ul>
<li>FILE *fp;定义文件指针。一定是野指针。</li>
<li>通过fopen（）；将fp初始化成为有效指针</li>
<li>通过使用文件操作函数来完成指针的读写操作。fputc、fgetc、puts、 gets、fputs、。。。。</li>
<li>通过fclose（）；将fp指针释放<br>【C语言中有三个特殊的文件指针由系统默认打开，用户无需定义即可直接使用】</li>
<li>stdin：标准输入，默认为当前终端（键盘），我们使用的scanf、getchar函数默认从此终端获得数据</li>
<li>stdout：标准输出，默认为当前终端（屏幕），我们使用的printf、puts、函数默认输出信息到此终端</li>
<li>stderr：标准出错，默认为当前终端（屏幕），我们使用的perror函数默认输出信息到此终端</li>
</ul>
<h5 id="文件操作一般步骤"><a href="#文件操作一般步骤" class="headerlink" title="文件操作一般步骤"></a>文件操作一般步骤</h5><ol>
<li>打开文件fopen（）——&gt;FILE *fp</li>
<li>对文件进行读写操作：</li>
</ol>
<ul>
<li>按字符读写文件fputc（）/fgetc（）；</li>
<li>按字符串（行）读写文件。fgets（）/fputs（）；</li>
<li>找文件结束标记。EOF/feof（）；</li>
</ul>
<ol start="3">
<li>关闭文件fclose（）；</li>
</ol>
<h5 id="打开、关闭文件函数："><a href="#打开、关闭文件函数：" class="headerlink" title="打开、关闭文件函数："></a>打开、关闭文件函数：</h5><p>打开：</p>
<blockquote>
<p>#include&lt;stdio.h&gt;<br>FILE *fp=NULL；<br>FILE *fopen(const char *filename,const char *mode);</p>
</blockquote>
<ul>
<li>参1：待打开的文件路径（绝对、相对）</li>
<li><p>参2：打开文件的方式</p>
<blockquote>
<p>“r”:只读方式打开。如果文件不存在，报错。如果文件存在，直接打开<br>“w”:只写方式打开。如果文件不存在，新建该文件。如果文件存在，将文件清空（截断）<br>“a”:以只写追加方式打开文件<br>“r+”:读写方式打开文件。如果文件不存在，报错。如果文件存在，直接打开。<br>“w+”:读写方式打开文件。如果文件不存在，新建该文件。如果文件存在，将文件清空（截断）<br>“a+”:读写追加方式打开文件。文件不存在创建文件，文件存在，写入源数据后打开<br>“b”:表示打开的文件是一个二进制文件。b只在windows中有效，在linux用r和rb结果一样</p>
</blockquote>
</li>
<li><p>返回值：</p>
</li>
</ul>
<blockquote>
<p>成功：指向成功打开的文件的“文件指针”fp<br>失败：NULL</p>
</blockquote>
<p>关闭：</p>
<blockquote>
<p>int fclose(FILE *stream);<br>参1：fopen返回值<br>返回值：成功0，失败-1；</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=<span class="literal">NULL</span>;</span><br><span class="line">    fp=fopen(<span class="string">"test.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp==<span class="literal">NULL</span>)   <span class="comment">/*返回空说明打开失败*/</span></span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);<span class="comment">/*标准出错打印函数，能打印出函数出错原因*/</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret=fclose(fp);</span><br><span class="line">    <span class="keyword">if</span>(ret==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"flose error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"--------成功打开、关闭文件"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>【任何文件使用之前必须打开】<br>【任何文件在使用后应该关闭】</p>
<h3 id="文件的顺序读写"><a href="#文件的顺序读写" class="headerlink" title="文件的顺序读写"></a>文件的顺序读写</h3><h6 id="按照字符读写文件fgetc、fputc"><a href="#按照字符读写文件fgetc、fputc" class="headerlink" title="按照字符读写文件fgetc、fputc"></a>按照字符读写文件fgetc、fputc</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *fileName=<span class="string">"C:/test/test.txt"</span>;</span><br><span class="line">    <span class="keyword">char</span> *mode=<span class="string">"w"</span>;  <span class="comment">/*文件已经存在清空源文件*/</span></span><br><span class="line">    FILE *fp=fopen(fileName,mode);</span><br><span class="line">    <span class="keyword">if</span>(!fp)      <span class="comment">/*fp==NULL*/</span></span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> ch=<span class="string">'x'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'y'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'y'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'\t'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'z'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'6'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);</span><br><span class="line">    ch=<span class="string">'\n'</span>;</span><br><span class="line">    fputc(ch,<span class="built_in">stdout</span>);  <span class="comment">/*putchar('A');==fputc('A',stdout);*/</span></span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="写入26个英文字母大写"><a href="#写入26个英文字母大写" class="headerlink" title="写入26个英文字母大写"></a>写入26个英文字母大写</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>，<span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)          <span class="comment">/*fp==NULl*/</span></span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> ch=<span class="number">0</span>;</span><br><span class="line">   <span class="comment">/* while(1)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        ch =fgetc(fp);</span></span><br><span class="line"><span class="comment">        if(ch==EOF)        //if(ch==-1)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            break;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        printf("%d\n",ch);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        ch=fgetc(fp);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%c"</span>,ch);</span><br><span class="line">    &#125;<span class="keyword">while</span>(ch!=EOF);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> ch=<span class="string">'A'</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch!=<span class="string">'Z'</span>+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fputc(ch,fp);</span><br><span class="line">        ch++;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="文件结束标记EOF"><a href="#文件结束标记EOF" class="headerlink" title="文件结束标记EOF"></a>文件结束标记EOF</h6><p>结束标记值：-1——&gt;#define EOF -1<br>只在文本文件中生效</p>
<ul>
<li>feof（）函数<blockquote>
<p>int feof(FILE *stream);<br>参1：文件指针<br>返回值：如果到达文件结尾，返回真值（非0值）</p>
<pre><code>0——&gt;没到结尾
</code></pre><p>既能判断文本文件，也能判断二进制文件的结尾<br>要想feof函数生效，必须在feof函数调用之前，调用读文件按操作。<br>【以EOF作为文件结束标志的文件，必须是文本文件】<br>【feof函数既可以判断二进制文件又可以判断文本文件】</p>
</blockquote>
</li>
</ul>
<h6 id="按照行读写文件fgets、fputs"><a href="#按照行读写文件fgets、fputs" class="headerlink" title="按照行读写文件fgets、fputs"></a>按照行读写文件fgets、fputs</h6><ul>
<li>fgets()函数：</li>
<li>从文件中读取字符串（行）数据，保存到参数一所制定的内存空间，直到出现换行字符、读到文件结尾或是已读了size-1个字符为止，最后会自动加上\0作为字符串结束</li>
<li>char *fgets(char *str,int size,FILE *stream);<blockquote>
<p>参1：用来存储读到的数据空间<br>参2：空间的大小<br>参3：数据来源的文件<br>返回值：成功：实际读到的字符串</p>
<pre><code>失败：NULL
读到文件末尾：NULL
</code></pre><p>【特性：】</p>
</blockquote>
</li>
<li>一次读一行数据，默认读到\n结束，读取\n</li>
<li>当参1空间不足时，预留\0的位置。实际读（空间的大小-1）个字符，自动添加\0</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> n=<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">char</span> *buf=<span class="built_in">malloc</span>(n);</span><br><span class="line">    <span class="built_in">memset</span>(buf,<span class="number">0</span>,n);</span><br><span class="line">    fgets(buf,n,fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>,buf);</span><br><span class="line">    <span class="built_in">free</span>(buf);</span><br><span class="line">    buf=<span class="literal">NULL</span>;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> n=<span class="keyword">sizeof</span>(<span class="keyword">char</span>)*<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">char</span> *buf=<span class="built_in">malloc</span>(n);</span><br><span class="line">    <span class="built_in">memset</span>(buf,<span class="number">0</span>,n);</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    while(1)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        fgets(buf,n,fp);</span></span><br><span class="line"><span class="comment">        printf("%s",buf);</span></span><br><span class="line"><span class="comment">        if(feof(fp))            //到达文件结尾</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            break;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">while</span>(!feof(fp))</span><br><span class="line">    &#123;</span><br><span class="line">        fgets(buf,n,fp);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s"</span>,buf);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(buf);</span><br><span class="line">    buf=<span class="literal">NULL</span>;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>fputs()函数：<blockquote>
<p>将一个字符串（行）数据，写入到指定文件中。不会自动添加\n标记<br>int fputs(const char *str,FILE *stream);<br>参1：待写出的字符<br>参2：写入的文件指针<br>返回值：成功：0，失败：-1</p>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> *str1=<span class="string">"happy\n"</span>;</span><br><span class="line">    <span class="keyword">char</span> *str2=<span class="string">"newyear"</span>;</span><br><span class="line">    <span class="built_in">fputs</span>(str1,fp);</span><br><span class="line">    <span class="built_in">fputs</span>(str2,fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>从键盘接收用户输入，写出一个文件，当用户输入“：！q”时，推出，关闭保存文件</li>
<li>模拟vi命令<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">char</span> *p=<span class="built_in">malloc</span>(<span class="number">1024</span>); <span class="comment">/*存储用户键盘输入的数据*/</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(p,<span class="number">0</span>,<span class="number">1024</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%[^\n]"</span>,p);   <span class="comment">/*\n作为结束标记*/</span></span><br><span class="line">        getchar();           <span class="comment">/*将终止scanf函数的\n从缓冲区中读走*/</span></span><br><span class="line">        fgets(p,<span class="number">1024</span>,<span class="built_in">stdin</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(p,<span class="string">":!p"</span>)==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">strcat</span>(p,<span class="string">"\n"</span>);</span><br><span class="line">        <span class="built_in">fputs</span>(<span class="string">"p,fp"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    p=<span class="literal">NULL</span>;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="文件版四则运算"><a href="#文件版四则运算" class="headerlink" title="文件版四则运算"></a>文件版四则运算</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="按照格式化文件fprintf、fscanf"><a href="#按照格式化文件fprintf、fscanf" class="headerlink" title="按照格式化文件fprintf、fscanf"></a>按照格式化文件fprintf、fscanf</h3><table>
<thead>
<tr>
<th style="text-align:center">键盘、屏幕</th>
<th style="text-align:center">string</th>
<th style="text-align:center">file</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">scanf</td>
<td style="text-align:center">sscanf</td>
<td style="text-align:center">fscanf</td>
</tr>
<tr>
<td style="text-align:center">printf</td>
<td style="text-align:center">sprintf</td>
<td style="text-align:center">fpritntf</td>
</tr>
</tbody>
</table>
<ul>
<li>写：fprintf<blockquote>
<p>int fprintf（FILE *stream,const char format,……）；<br>功能：根据参数format字符串转换并格式化数据，然后将结果输出到stream指定的文件中，指定出现字符串结束符：\0为止<br>参数：待写入的文件指针<br>参2：格式串<br>变参：对应格式串的数据<br>返回值：成功：实际写入文件的字符个数（不会自动包含\0）</p>
<pre><code>失败：-1；
</code></pre></blockquote>
</li>
</ul>
<ul>
<li>读：fscanf（）函数<blockquote>
<p>interestingfscanf（FILE *stream,const char *format,….）;<br>参1：带操作的文件指针<br>参2：格式串<br>变参：对应格式串的数据<br>返回值：成功：实际成功匹配数据个数。如果匹配失败，后续的匹配符自动失效。成功匹配几次，返回几<br>失败：-1；<br>fscanf函数每次调用时，会自动判断下一次参2是否满足匹配条件，如果不满足匹配条件，提前使feof（）为真</p>
</blockquote>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write_file</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>, <span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">fprintf</span>(fp,<span class="string">"%d%c%d=%d\n"</span>,<span class="number">10</span>,<span class="string">'+'</span>,<span class="number">4</span>,<span class="number">4</span> + <span class="number">10</span>);</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_file</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a, b, c;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fscanf</span>(fp, <span class="string">"%d%c%d=%d\n"</span>, &amp;a, &amp;ch, &amp;b, &amp;c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d%c%d=%d\n"</span>, a, ch, b, c);</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    write_file();</span><br><span class="line">    read_file();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"--------读写完成\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="文件版排序"><a href="#文件版排序" class="headerlink" title="文件版排序"></a>文件版排序</h5><ul>
<li>思路：</li>
</ul>
<ol>
<li>产生随机数，写入文件<blockquote>
<p>srand(time(NULL));  //#inlcude &lt;stdlib.h&gt;<br>rand()%100;  //0-99<br>fprintf(fp,”%d\n”,rand()%100);</p>
</blockquote>
</li>
<li>读文件取出随机数<br>fscnaf()——&gt;取出   存入数组中（栈、堆以数据大小选择）</li>
<li><p>排序（如冒泡）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;n<span class="number">-1</span>-i;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[j]&lt;arr[j+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            temp=arr[j];</span><br><span class="line">            arr[j]=arr[j+<span class="number">1</span>];</span><br><span class="line">            arr[j+<span class="number">1</span>]=temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>写回到文件</p>
</li>
</ol>
<ul>
<li>fopen(“w”);</li>
<li>fprintf()写入文件</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stido.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 10</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">w_file</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_file</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    w_file();</span><br><span class="line">    getchar();</span><br><span class="line">    r_file();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">w_file</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"w fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(fp,<span class="string">"%d\n"</span>,rand()%<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BubbleSort</span><span class="params">(<span class="keyword">int</span> *src, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len - <span class="number">1</span> - i;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (src[j]&gt;src[j + <span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = src[j];</span><br><span class="line">                src[j] = src[j + <span class="number">1</span>];</span><br><span class="line">                src[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">r_file</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> arr[N];</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>, i = <span class="number">0</span>;</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(fp,<span class="string">"%d\n"</span>,&amp;num);</span><br><span class="line">        arr[i] = num;</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span> (feof(fp))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"i=%d\n"</span>,i);</span><br><span class="line"></span><br><span class="line">    BubbleSort(arr, i);</span><br><span class="line">    fclose(fp);</span><br><span class="line"></span><br><span class="line">    fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"w 2 fopen error"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(fp,<span class="string">"%d\n"</span>,arr[j]);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="按照块读写文件fread、fwrite"><a href="#按照块读写文件fread、fwrite" class="headerlink" title="按照块读写文件fread、fwrite"></a>按照块读写文件fread、fwrite</h3><p>【总结】：</p>
<table>
<thead>
<tr>
<th style="text-align:center">读写字符文件</th>
<th style="text-align:center">读写字符、二进制文件</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">fputc、fgetc</td>
<td style="text-align:center">fread、fwrite</td>
</tr>
<tr>
<td style="text-align:center">fputs、fgets</td>
</tr>
<tr>
<td style="text-align:center">fprintf、fscanf</td>
</tr>
</tbody>
</table>
<h4 id="fwrite-、fread-函数"><a href="#fwrite-、fread-函数" class="headerlink" title="fwrite()、fread()函数"></a>fwrite()、fread()函数</h4><blockquote>
<p>fwrite()</p>
</blockquote>
<p>以二进制形式写数据到文件中<br>size_t fwrite(const void *ptr,size_t size,size_ nmemb,FILE *stream);</p>
<ul>
<li>参数1：待写入的数据的首地址</li>
<li>参数2：一次写入的数据大小</li>
<li>参数3：写入的次数           //总大小=参2*参3</li>
<li>参数4：文件指针</li>
<li>返回值：永远返回参数3（成功）——&gt;通常将参2：传1，将参3：传实际大小。<br>失败返回0<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">&#125;<span class="keyword">stu_t</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">stu_t</span> s1[<span class="number">4</span>]=</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">19</span>,<span class="string">"andy"</span>,<span class="number">34</span>,</span><br><span class="line">        <span class="number">12</span>,<span class="string">"cany"</span>,<span class="number">33</span>,</span><br><span class="line">        <span class="number">14</span>,<span class="string">"lycy"</span>,<span class="number">32</span>,</span><br><span class="line">        <span class="number">16</span>,<span class="string">"mike"</span>,<span class="number">31</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    FILE *fp=fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w"</span>);</span><br><span class="line">    <span class="keyword">if</span>(!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret =fwrite(&amp;s1[<span class="number">0</span>],<span class="keyword">sizeof</span>(<span class="keyword">stu_t</span>),<span class="number">4</span>,fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"ret=%d\n"</span>,ret);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>fread()</p>
</blockquote>
<p>size_t fread(void *ptr,size_t size,size_t nmemb,FILE *stream);</p>
<ul>
<li>参数1：用来存储数据空间的首地址</li>
<li>参数2：一次读到空间的数据大小</li>
<li>参数3：读入的次数     //总大小=参2*参3</li>
<li>参数4：文件指针</li>
<li>返回值：大多数返回：参3。实际数据&gt;参3：返回参3。实际数据&lt;参3：返回实际字节数</li>
<li>失败返回0；0表示到达文件结尾<br>【通常将参2，传1，参3：存储总空间的大小】<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">&#125;<span class="keyword">stu_t</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">stu_t</span> *p = <span class="built_in">malloc</span>(<span class="number">4096</span>);</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">    <span class="keyword">if</span> (!fp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fopen error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret = fread(p, <span class="number">1</span>, <span class="number">4096</span>, fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"ret=%d\n"</span>, ret);</span><br><span class="line">    <span class="keyword">int</span> n = ret / <span class="keyword">sizeof</span>(<span class="keyword">stu_t</span>);   <span class="comment">/*元素个数*/</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i= <span class="number">0</span>; i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"age=%d,name=%s,num=%d\n"</span>, p[i].age, p[i].name, p[i].num);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="二进制文件的拷贝"><a href="#二进制文件的拷贝" class="headerlink" title="二进制文件的拷贝"></a>二进制文件的拷贝</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc,<span class="keyword">char</span>*argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> buf[<span class="number">4096</span>]=&#123;<span class="number">0</span>&#125;,ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(argc!=<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"参数输入有误\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    FILE *rfp=fopen(argv[<span class="number">1</span>],<span class="string">"rb"</span>);<span class="comment">/*argv[1]指代源文件*/</span></span><br><span class="line">    <span class="keyword">if</span>(!rfp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"rfp open error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    FILE *wfp=fopen(argv[<span class="number">2</span>],<span class="string">"wb"</span>);<span class="comment">/*argv[2]指代目标文件*/</span></span><br><span class="line">    <span class="keyword">if</span>(!wfp)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"rfp open error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(buf,<span class="number">0</span>,<span class="keyword">sizeof</span>(buf));</span><br><span class="line">        ret=fread((<span class="keyword">void</span>*)buf,<span class="number">1</span>,<span class="keyword">sizeof</span>(buf),rfp);</span><br><span class="line">        <span class="keyword">if</span>(ret==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        fwrite(bur,<span class="number">1</span>,ret,wfp);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(rfp);</span><br><span class="line">    fclose(wfp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="随机读写文件"><a href="#随机读写文件" class="headerlink" title="随机读写文件"></a>随机读写文件</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">&#125;<span class="keyword">stu_t</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">stu_t</span> stu[<span class="number">4</span>] =</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="number">18</span>, <span class="string">"aaa"</span>, <span class="number">34</span>,</span><br><span class="line">        <span class="number">148</span>, <span class="string">"agaa"</span>, <span class="number">324</span>,</span><br><span class="line">        <span class="number">178</span>, <span class="string">"asaa"</span>, <span class="number">394</span>,</span><br><span class="line">        <span class="number">183</span>, <span class="string">"anaa"</span>, <span class="number">342</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">stu_t</span> s1;</span><br><span class="line">    FILE *fp = fopen(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>,<span class="string">"w+"</span>);</span><br><span class="line">    <span class="keyword">int</span> ret = fwrite(&amp;stu[<span class="number">0</span>],<span class="number">1</span>,<span class="keyword">sizeof</span>(stu),fp);      <span class="comment">/*写数据到文件*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"ret=%d\n"</span>,ret);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ret = fseek(fp,0,SEEK_END);           /*设置文件读写位置到文件末尾*/</span></span><br><span class="line">    ret = fseek(fp, <span class="keyword">sizeof</span>(<span class="keyword">stu_t</span>), SEEK_SET);  <span class="comment">/*设置读写位置到文件开头向后偏过stu元素*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ret == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">"fseek error"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"ret=%d\n"</span>,ret);</span><br><span class="line"></span><br><span class="line">    fread(&amp;s1, <span class="number">1</span>, <span class="keyword">sizeof</span>(<span class="keyword">stu_t</span>), fp);  <span class="comment">/*读取文件内容*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"1 age=%d,name=%s,num=%d\n"</span>,s1.age,s1.name,s1.num);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> len = ftell(fp);        <span class="comment">/*获取偏移量*/</span>                               </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"len=%d\n"</span>,len);</span><br><span class="line"></span><br><span class="line">    rewind(fp);                 <span class="comment">/*回卷光标读写位置到起始*/</span></span><br><span class="line"></span><br><span class="line">    fread(&amp;s1,<span class="number">1</span>,<span class="keyword">sizeof</span>(<span class="keyword">stu_t</span>),fp);   <span class="comment">/*读取文件内容*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"2 age=%d,name=%s,num=%d"</span>,s1.age,s1.name,s1.num);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="获取文件状态"><a href="#获取文件状态" class="headerlink" title="获取文件状态"></a>获取文件状态</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">stat</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, struct stat *buf)</span></span>;</span><br></pre></td></tr></table></figure>
<p>功能：获取文件状态信息<br>参数1：文件名<br>参数2：保存文件信息的结构体<br>返回值：成功：0     失败：-1<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span> &#123;</span></span><br><span class="line">    <span class="keyword">dev_t</span>         st_dev;         <span class="comment">//文件的设备编号</span></span><br><span class="line">    <span class="keyword">ino_t</span>         st_ino;          <span class="comment">//节点</span></span><br><span class="line">    <span class="keyword">mode_t</span>        st_mode;   <span class="comment">//文件的类型和存取的权限</span></span><br><span class="line">    <span class="keyword">nlink_t</span>       st_nlink;     <span class="comment">//连到该文件的硬连接数目，刚建立的文件值为1</span></span><br><span class="line">    <span class="keyword">uid_t</span>         st_uid;         <span class="comment">//用户ID</span></span><br><span class="line">    <span class="keyword">gid_t</span>         st_gid;         <span class="comment">//组ID</span></span><br><span class="line">    <span class="keyword">dev_t</span>         st_rdev;      <span class="comment">//(设备类型)若此文件为设备文件，则为其设备编号</span></span><br><span class="line">    <span class="keyword">off_t</span>         st_size;        <span class="comment">//文件字节数(文件大小)</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> st_blksize;   <span class="comment">//块大小(文件系统的I/O 缓冲区大小)</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> st_blocks;    <span class="comment">//块数</span></span><br><span class="line">    <span class="keyword">time_t</span>        st_atime;     <span class="comment">//最后一次访问时间</span></span><br><span class="line">    <span class="keyword">time_t</span>        st_mtime;    <span class="comment">//最后一次修改时间</span></span><br><span class="line">    <span class="keyword">time_t</span>        st_ctime;     <span class="comment">//最后一次改变时间(指属性)</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>不打开文件获取文件大小</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">buf</span>;</span></span><br><span class="line">    <span class="keyword">int</span> ret = stat(<span class="string">"C:/Users/0.0/Downloads/a.txt"</span>, &amp;buf);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, buf.st_size);</span><br><span class="line"></span><br><span class="line">    system(<span class="string">"pause"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="删除、重命名文件："><a href="#删除、重命名文件：" class="headerlink" title="删除、重命名文件："></a>删除、重命名文件：</h3><ul>
<li>删除文件   int remove(const char *pathname);   </li>
<li>重命名     int rename(const char <em>oldpath, const char </em>newpath);   </li>
</ul>
<h3 id="文件缓冲区"><a href="#文件缓冲区" class="headerlink" title="文件缓冲区"></a>文件缓冲区</h3><ul>
<li><p>ANSI C标准采用“缓冲文件系统”处理数据文件。</p>
</li>
<li><p>所谓缓冲文件系统是指系统自动地在内存区为程序中每一个正在使用的文件开辟一个文件缓冲区从内存向磁盘输出数据必须先送到内存中的缓冲区，装满缓冲区后才一起送到磁盘去。</p>
</li>
<li><p>如果从磁盘向计算机读入数据，则一次从磁盘文件将一批数据输入到内存缓冲区(充满缓冲区)，然后再从缓冲区逐个地将数据送到程序数据区(给程序变量</p>
</li>
</ul>
<h4 id="缓冲区刷新"><a href="#缓冲区刷新" class="headerlink" title="缓冲区刷新"></a>缓冲区刷新</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fflush</span><span class="params">(FILE *stream)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>功能：更新缓冲区，让缓冲区的数据立马写到文件中</li>
<li>参数：文件指针</li>
<li>返回值：成功：0；失败：-1；</li>
</ul>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            发布于&nbsp;
            <time datetime="2018-05-26T16:00:00.000Z" itemprop="datePublished">
              2018-05-27
            </time>
          </div>
          
            <div>
              tags: 
  <li class="meta-text">
  { <a href="/tags/C语言/">C语言</a> }
  </li>


            </div>
          
      </section>
    
    
</article>

  
</div>

            <footer>
    <div>© 2018 - ZhangBinchen </div>
    <div>
    ZhangBinchen's Blog
    </div>
</footer>

        </div>
    </div>
</div>
<script src="/js/pager/dist/singlepager.js"></script>
<script>
var sp = new Pager('data-pager-shell')

</script>
</body>
</html>